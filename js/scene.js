import*as i from"./_snowpack/pkg/three.js";import*as u from"./_snowpack/pkg/three/addons.js";import{SolarSystem as g}from"./solarSystem.js";import{ExoplanetSystem as f}from"./exoplanetSystem.js";let d=!1,l,a,s,p;export async function initScene(o,t=!1){if(d)return;d=!0;const n=document.querySelector(o),r=new i.WebGLRenderer({antialias:!0,canvas:n,alpha:!0});r.setPixelRatio(window.devicePixelRatio);{l=new i.Scene;const e=await new i.TextureLoader().loadAsync("images/image_background_stars.jpg");e.mapping=i.EquirectangularReflectionMapping,e.colorSpace=i.SRGBColorSpace,l.background=e}{const e=new i.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e4);l.add(e);const c=new u.OrbitControls(e,n);c.target.set(0,0,0),c.dampingFactor=.2,c.enableDamping=!0,a=new w(e,c)}{const e=new i.AmbientLight("#ffffff",.1);l.add(e)}const m=new y;if(s=new g,await s.initAsync(),m.positionGroup(s),l.add(s),p=new f,await p.initAsync(),m.positionGroup(p),l.add(p),t)a.Camera.position.set(10,10,10);else{const e=s.Earth.getWorldPosition(new i.Vector3),c=s.Earth.geometry.parameters.radius;a.Camera.position.set(e.x-c*2,e.y,e.z),a.Controls.target.copy(e)}h(r)}export function showPlanet(o,t){p.prepare(o);const n=(t?p.Star:p.Planet).getWorldPosition(new i.Vector3),r=(t?p.Star:p.Planet).geometry.parameters.radius;a.Camera.position.set(n.x-r*2,n.y,n.z),a.Controls.target.copy(n)}export function showSolarSystem(o){const t=(o?s.Sun:s.Earth).getWorldPosition(new i.Vector3),n=(o?s.Sun:s.Earth).geometry.parameters.radius;a.Camera.position.set(t.x-n*2,t.y,t.z),a.Controls.target.copy(t)}function h(o){requestAnimationFrame(t);function t(r){const m=r*.001;if(n()){const e=o.domElement;a.Camera.aspect=e.clientWidth/e.clientHeight,a.Camera.updateProjectionMatrix()}s.animate(r),a.Controls.update(),o.render(l,a.Camera),requestAnimationFrame(t)}function n(){const r=o.domElement,m=r.clientWidth,e=r.clientHeight,c=r.width!==m||r.height!==e;return c&&o.setSize(m,e,!1),c}}class w{constructor(t,n){this.Camera=t,this.Controls=n}}class y{constructor(){this.sceneGroupXPosition=0,this.sceneGroupXPositionIncrementor=1e3}positionGroup(t){t.position.set(this.sceneGroupXPosition++*this.sceneGroupXPositionIncrementor,0,0)}}
